<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CaseGuard</title>

<style>
body{
    font-family: Arial, Helvetica, sans-serif;
    background:#f5f6f8;
    margin:0;
    padding:0;
}

.container{
    max-width:700px;
    margin:auto;
    padding:18px;
}

.card{
    background:white;
    padding:18px;
    border-radius:10px;
    box-shadow:0 2px 8px rgba(0,0,0,0.08);
}

textarea{
    width:100%;
    height:160px;
    padding:10px;
    font-size:15px;
    border-radius:8px;
    border:1px solid #ccc;
    resize:vertical;
}

button{
    width:100%;
    padding:12px;
    margin-top:10px;
    font-size:16px;
    border:none;
    border-radius:8px;
    background:#111;
    color:white;
    cursor:pointer;
}

button:hover{
    background:#333;
}

.result{
    margin-top:18px;
    white-space:pre-wrap;
}

.label{
    font-weight:bold;
    margin-top:10px;
}

.small{
    color:#666;
    font-size:14px;
}

/* spinner */
.loader {
  border: 4px solid #eee;
  border-top: 4px solid #111;
  border-radius: 50%;
  width: 34px;
  height: 34px;
  animation: spin 0.8s linear infinite;
  margin: 18px auto;
  display: none;
}

@keyframes spin {
  0% { transform: rotate(0deg);}
  100% { transform: rotate(360deg);}
}
</style>
</head>

<body>

<div class="container">

    <div style="text-align:center;margin-bottom:16px;">
        <h1 style="margin:0;">CaseGuardâ„¢</h1>
        <div class="small">Medical documentation assistant</div>
    </div>

    <div class="card">

        <input id="email" placeholder="Registered email" style="width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc;">

        <textarea id="note" placeholder="Paste case note here..."></textarea>

        <button onclick="analyze()">Review Documentation</button>

        <div id="loader" class="loader"></div>

        <div class="result" id="result"></div>

    </div>
</div>

<script>
async function analyze(){

    const email = document.getElementById("email").value;
    const note = document.getElementById("note").value;

    if(!note){
        alert("Paste a case note");
        return;
    }

    document.getElementById("loader").style.display="block";
    document.getElementById("result").innerHTML="";

    try{
        const res = await fetch("https://caseguard.onrender.com/analyze",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({email:email,note:note})
        });

        const data = await res.json();

        if(data.error){
            document.getElementById("result").innerHTML = "<b>"+data.error+"</b>";
        }
        else{
            document.getElementById("result").innerHTML =
            "<div class='label'>Risk Level</div>"+data.classification+
            "<div class='label'>Suggested Documentation Improvements</div>"+(data.suggested_documentation||"None")+
            "<div class='label'>Defensible Chart Version</div>"+data.defensible_note;
        }
    }
    catch(e){
        document.getElementById("result").innerHTML="Server error";
    }

    document.getElementById("loader").style.display="none";
}
</script>

</body>
</html>
